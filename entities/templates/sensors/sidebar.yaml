unique_id: sidebar
state: template
attributes:
  time: >
    {% set hours = now().strftime('%H') %}
    {% set minutes = now().strftime('%M') %}
    <span class="time">
      {{ hours }}<span class="time-colon">:</span>{{ minutes }}
    </span>
  date: |
    <font color='#6a7377'><b>
    {%- if strptime(states('sensor.date'), '%Y-%m-%d').day != null %}
    {%- set days = ['Maandag', 'Dinsdag', 'Woensdag', 'Donderdag', 'Vrijdag', 'Zaterdag', 'Zondag'] %}
    {%- set months = ['Januari', 'Februari', 'Maart', 'April', 'Mei', 'Juni', 
    'Juli', 'Augustus', 'September', 'Oktober', 'November', 'December'] %}
      {{- days[now().weekday()] }}<br>
      {{- strptime(states('sensor.date'), '%Y-%m-%d').day }} {{ months[now().month-1] }}
    {%- endif -%}
    </b></font>
  greet: |
    <b>
    {%- set time = now().hour %}
    {%- if time <= 1 -%} Goedenacht {{'\U0001F611'}}
    {%- elif time <= 3 -%} Goedenacht {{'\U0001F62A'}}
    {%- elif time <= 5 -%} Goedenacht {{'\U0001F634'}}
    {%- elif time <= 7 -%} Goedemorgen {{'\U0001F4A9'}}
    {%- elif time <= 9 -%} Goedemorgen {{'\u2615\uFE0F'}}
    {%- elif time <= 10 -%} Goedemorgen {{'\U0001F642'}}
    {%- elif time <= 13 -%} Goedemiddag {{'\U0001F60A'}}
    {%- elif time <= 15 -%} Goedemiddag {{'\U0001F60E'}}
    {%- elif time <= 17 -%} Goedemiddag {{'\U0001F44B\U0001F3FB'}}
    {%- elif time <= 19 -%} Goedenavond {{'\U0001F44B\U0001F3FB'}}
    {%- elif time <= 22 -%} Goedenavond {{'\U0001F60C'}}
    {%- elif time <= 23 -%} Goedenavond {{'\U0001F974'}}
    {%- else %} Goedenavond {{'\U0001F974'}}
    {%- endif -%}
    </b>

  weather: |
    {%- set temperature = states('sensor.br_temperature') or 0 %}
    {%- set apparent = (states('sensor.buienradar_feel_temperature')) or 0 | round(0) %}
    {%- set precip = (states('sensor.br_precipitation') or 0) | round(0) %}
    {% if not is_state('sensor.br_temperature', 'unknown') %}
      {%- if temperature | float(default=0) <= 0.0 -%}
        Voelt als {{ apparent }}° met {{ precip }}% kans op sneeuw {{'\u2744\uFE0F'}}
      {%- elif temperature | float(default=0) > 0.0 -%} 
        Voelt als {{ apparent}}° met {{ precip }}% kans op regen {{ '\u2614\uFE0F' if precip > 30 }}
      {%- endif %}
    {%- else %}
      Kan weersinformatie niet laden...
    {%- endif %}
  # rudolf: |
  #   {%- set start_time = state_attr('calendar.r_offereins_gmail_com', 'start_time') %}
  #   {%- set end_time = state_attr('calendar.r_offereins_gmail_com', 'end_time') %}
  #   {% if start_time != None %}
  #     {%- set time = as_timestamp(start_time) | timestamp_custom('%H:%M') %}
  #     {%- set time_end = as_timestamp(end_time) | timestamp_custom('%H:%M') %}
  #     {%- set hours = as_timestamp(start_time) | timestamp_custom('%H') | int(default=0) / 24 %}
  #     {%- set count = (as_timestamp(start_time) - as_timestamp(now())) / 86400 - hours %}
  #     {%- set day = strptime(start_time, '%Y-%m-%d %H:%M:%S').strftime('%A')
  #     | replace('Monday', 'Maandag')
  #     | replace('Tuesday', 'Dinsdag')
  #     | replace('Wednesday', 'Woensdag')
  #     | replace('Thursday', 'Donderdag')
  #     | replace('Friday', 'Vrijdag')
  #     | replace('Saturday', 'Zaterdag')
  #     | replace('Sunday', 'Zondat') %}
  #     {%- if count <= 0.0 -%}
  #       {{'\U0001F6D2'}} Rudolf vandaag tussen {{ time }}-{{ time_end }}
  #     {%- elif count <= 1.0 -%}
  #       Rudolf morgen tussen {{ time }}-{{ time_end }}
  #     {%- elif count <= 2.0 -%}
  #       Rudolf overmorgen tussen {{ time }}-{{ time_end }}
  #     {%- else -%}
  #       Rudolf als {{ (count + hours) | round(0) }} dagen op {{ day }} tussen {{ time }}-{{ time_end }}
  #     {%- endif %}
  #   {%- endif %}
